# excercise
$PSVersionTable"I found a \match" -match "I""I found a \match" -match "\match""can you find the . in here" -match ".""can you find the . in here" -match "f..d""can you find the . in here" -match "c....""can you find the . in here" -match "\."(Get-Date) -match "202\d"$Matches$ip = (Get-NetIPAddress -InterfaceAlias ethernet -AddressFamily ipv4).IPaddress$iptest = "The ip $ip is a local subnet"$iptest$iptest -match "\d\d\d.\d\d\d.\d.\d"$iptest -match '\d{1,3}.\d{1,3}.\d{1,3}.\d{1,3}'$iptest -match '\w+.\w+.\w+.\w+'$iptest -match '\d+.\d+.\d+.\d+'# Exercise 2: $matches system variable and regex grouping $string = "1,2,3,42,54,67,145,3975"$string -match "\d\d"$Matches$array = 1,2,3,42,54,67,145,3975$array -match "\d\d"[string]$array -match '\d\d'$matches.value$Matches | Get-Member$Matches.GetType()# Task 2.2: Working with Named regex groupsGet-WindowsUpdateLog -LogPath "$HOME\Desktop\updateagent.log"$updatefile = Get-Content -Path "$HOME\Desktop\updateagent.log"[string]$updatefile -match "\d{2}\.\d\.\d{5}\.\d{1,4}"(?<test>)[string]$updatefile -match "(\d{2})\.(\d)\.(\d{5})\.(\d{1,4})"[string]$updatefile -match "(?<Major>\d{2})\.(\d)\.(\d{5})\.(\d{1,4})"[string]$updatefile -match "(?<Major>\d{2})\.(?<Minor>\d)\.(?<Build>\d{5})\.(?<Revision>\d{1,4})"$Matches$updatefile -match "(\d{2})\.(\d)\.(\d{5})\.(\d{1,4})" -replace "(\d{2})\.(\d)\.(\d{5})\.(\d{1,4})",'the version is windows $1 with build number $3'Get-Command -Noun WebRequest$sites = 'https://support.microsoft.com/en-us/topic/windows-10-update-history-93345c32-4ae1-6d1c-f885-6c0b718adf3b','https://support.microsoft.com/en-us/topic/windows-10-update-history-2ad7900f-882c-1dfc-f9d7-82b7ca162010','https://support.microsoft.com/en-us/topic/windows-10-and-windows-server-2016-update-history-4acfbc84-a290-1b54-536a-1c0430e9f3fd','https://support.microsoft.com/en-us/topic/windows-10-update-history-83aa43c0-82e0-92d8-1580-10642c9ed612','https://support.microsoft.com/en-us/topic/windows-10-and-windows-server-update-history-8e779ac1-e840-d3b8-524e-91037bf7645a','https://support.microsoft.com/en-us/topic/windows-10-update-history-0d8c2da6-3dba-66e4-2ef2-059192bf7869','https://support.microsoft.com/en-us/topic/windows-10-and-windows-server-2019-update-history-725fc2e1-4443-6831-a5ca-51ff5cbcb059'$sites$websitecontent = $sites | ForEach-Object -Process {Invoke-WebRequest -Uri $_ -UseBasicParsing}$websitecontent $Websitecontent | Get-Member$firstsite = $Websitecontent[0].RawContent$firstsite -match '10240'$firstsite -match ".+10240.+"$matches$matches[0]"10240" -match ".+10240""any char 10240" -match ".+10240"" 10240" -match ".+10240"$firstsite -match ".*10240"$firstsite -match ".*10240.*"$arrayfirstsite = $firstsite -split "\n"$arrayfirstsite -match 'h1'$arrayfirstsite -match 'h1|h2|h3|h4'$arrayfirstsite -match 'h[1234]'$firstsite -match '.*footer.*'$firstsite -match '^<footer'$firstsite -match '(?m)<footer.*'# Microsoft.PowerShell.Commands.BasicHtmlWebResponseObject[regex] | Get-Member -Static[regex]::Match($websitecontent.Rawcontent,"10240")[regex]::Matches($websitecontent.Rawcontent,"10240")[regex]::Matches($websitecontent.Rawcontent,".*10240.*")[regex]::Matches($websitecontent.Rawcontent,'\w+ \d{1,2}, \d{4}.*KB\d*.*10240\.\d*.*')[regex]::Matches($websitecontent.Rawcontent,'(?<Date>\w+ \d{1,2}, \d{4}).*(?<KB>KB\d*).*(?<Version>10240\.\d*)')[regex]::Matches($websitecontent.Rawcontent,'(?<date>\w+ \d{1,2}, \d{4}).*(?<kb>KB\d*).*(?<Version>10240\.\d*)').Groups | Format-Table$versiontableraw = [regex]::Matches($websitecontent.Rawcontent,'(?<date>\w+ \d{1,2}, \d{4}).*(?<kb>KB\d*).*(?<Version>10240\.\d*)')$versiontable = $versiontableraw | Select-Object @{Name="Kb Number";Expression={($_.groups)[2].value.TrimStart("KB")}},@{Name="Release date";Expression={(get-date ($_.groups)[1].value)}},@{Name="Windows Version";Expression={($_.groups)[3].Value}}$versiontable$versiontableraw = [regex]::Matches($websitecontent.Rawcontent,'(?<date>\w+ \d{1,2}, \d{4}).*(?<kb>KB\d*).*(?<Version>10240\.\d*)')$versiontableraw += [regex]::Matches($websitecontent.Rawcontent,'(?<date>\w+ \d{1,2}, \d{4}).*(?<kb>KB\d*).*(?<Version>10586\.\d*)')$versiontableraw += [regex]::Matches($websitecontent.Rawcontent,'(?<date>\w+ \d{1,2}, \d{4}).*(?<kb>KB\d*).*(?<Version>14393\.\d*)')$versiontableraw += [regex]::Matches($websitecontent.Rawcontent,'(?<date>\w+ \d{1,2}, \d{4}).*(?<kb>KB\d*).*(?<Version>15063\.\d*)')$versiontableraw += [regex]::Matches($websitecontent.Rawcontent,'(?<date>\w+ \d{1,2}, \d{4}).*(?<kb>KB\d*).*(?<Version>16299\.\d*)')$versiontableraw += [regex]::Matches($websitecontent.Rawcontent,'(?<date>\w+ \d{1,2}, \d{4}).*(?<kb>KB\d*).*(?<Version>17134\.\d*)')$versiontableraw += [regex]::Matches($websitecontent.Rawcontent,'(?<date>\w+ \d{1,2}, \d{4}).*(?<kb>KB\d*).*(?<Version>17763\.\d*)')$versiontable = $versiontableraw | Select-Object @{Name='Kb Number';Expression={($_.groups)[2].value.TrimStart('KB')}},@{Name='Release date';Expression={(get-date ($_.groups)[1].value)}},@{Name='Windows Version';Expression={($_.groups)[3].Value}}$versiontable$sites = `'https://support.microsoft.com/en-us/topic/windows-10-update-history-93345c32-4ae1-6d1c-f885-6c0b718adf3b',`'https://support.microsoft.com/en-us/topic/windows-10-update-history-2ad7900f-882c-1dfc-f9d7-82b7ca162010',`'https://support.microsoft.com/en-us/topic/windows-10-and-windows-server-2016-update-history-4acfbc84-a290-1b54-536a-1c0430e9f3fd',`'https://support.microsoft.com/en-us/topic/windows-10-update-history-83aa43c0-82e0-92d8-1580-10642c9ed612',`'https://support.microsoft.com/en-us/topic/windows-10-and-windows-server-update-history-8e779ac1-e840-d3b8-524e-91037bf7645a',`'https://support.microsoft.com/en-us/topic/windows-10-update-history-0d8c2da6-3dba-66e4-2ef2-059192bf7869',`'https://support.microsoft.com/en-us/topic/windows-10-and-windows-server-2019-update-history-725fc2e1-4443-6831-a5ca-51ff5cbcb059'$websitecontent = $sites | ForEach-Object -Process {Invoke-WebRequest -Uri $_ -UseBasicParsing}$versiontableraw = [regex]::Matches($websitecontent.Rawcontent,'(?<date>\w+ \d{1,2}, \d{4}).*(?<kb>KB\d*).*(?<Version>10240\.\d*)')$versiontableraw += [regex]::Matches($websitecontent.Rawcontent,'(?<date>\w+ \d{1,2}, \d{4}).*(?<kb>KB\d*).*(?<Version>10586\.\d*)')$versiontableraw += [regex]::Matches($websitecontent.Rawcontent,'(?<date>\w+ \d{1,2}, \d{4}).*(?<kb>KB\d*).*(?<Version>14393\.\d*)')$versiontableraw += [regex]::Matches($websitecontent.Rawcontent,'(?<date>\w+ \d{1,2}, \d{4}).*(?<kb>KB\d*).*(?<Version>15063\.\d*)')$versiontableraw += [regex]::Matches($websitecontent.Rawcontent,'(?<date>\w+ \d{1,2}, \d{4}).*(?<kb>KB\d*).*(?<Version>16299\.\d*)')$versiontableraw += [regex]::Matches($websitecontent.Rawcontent,'(?<date>\w+ \d{1,2}, \d{4}).*(?<kb>KB\d*).*(?<Version>17134\.\d*)')$versiontableraw += [regex]::Matches($websitecontent.Rawcontent,'(?<date>\w+ \d{1,2}, \d{4}).*(?<kb>KB\d*).*(?<Version>17763\.\d*)')$versiontable = $versiontableraw | Select-Object @{Name='Kb Number';Expression={($_.groups)[2].value.TrimStart('KB')}},@{Name='Release date';Expression={(get-date ($_.groups)[1].value)}},@{Name='Windows Version';Expression={($_.groups)[3].Value}}$versiontable

# full code
$sites = `'https://support.microsoft.com/en-us/topic/windows-10-update-history-93345c32-4ae1-6d1c-f885-6c0b718adf3b',`'https://support.microsoft.com/en-us/topic/windows-10-update-history-2ad7900f-882c-1dfc-f9d7-82b7ca162010',`'https://support.microsoft.com/en-us/topic/windows-10-and-windows-server-2016-update-history-4acfbc84-a290-1b54-536a-1c0430e9f3fd',`'https://support.microsoft.com/en-us/topic/windows-10-update-history-83aa43c0-82e0-92d8-1580-10642c9ed612',`'https://support.microsoft.com/en-us/topic/windows-10-and-windows-server-update-history-8e779ac1-e840-d3b8-524e-91037bf7645a',`'https://support.microsoft.com/en-us/topic/windows-10-update-history-0d8c2da6-3dba-66e4-2ef2-059192bf7869',`'https://support.microsoft.com/en-us/topic/windows-10-and-windows-server-2019-update-history-725fc2e1-4443-6831-a5ca-51ff5cbcb059'$websitecontent = $sites | ForEach-Object -Process {Invoke-WebRequest -Uri $_ -UseBasicParsing}$versiontableraw = [regex]::Matches($websitecontent.Rawcontent,'(?<date>\w+ \d{1,2}, \d{4}).*(?<kb>KB\d*).*(?<Version>10240\.\d*)')$versiontableraw += [regex]::Matches($websitecontent.Rawcontent,'(?<date>\w+ \d{1,2}, \d{4}).*(?<kb>KB\d*).*(?<Version>10586\.\d*)')$versiontableraw += [regex]::Matches($websitecontent.Rawcontent,'(?<date>\w+ \d{1,2}, \d{4}).*(?<kb>KB\d*).*(?<Version>14393\.\d*)')$versiontableraw += [regex]::Matches($websitecontent.Rawcontent,'(?<date>\w+ \d{1,2}, \d{4}).*(?<kb>KB\d*).*(?<Version>15063\.\d*)')$versiontableraw += [regex]::Matches($websitecontent.Rawcontent,'(?<date>\w+ \d{1,2}, \d{4}).*(?<kb>KB\d*).*(?<Version>16299\.\d*)')$versiontableraw += [regex]::Matches($websitecontent.Rawcontent,'(?<date>\w+ \d{1,2}, \d{4}).*(?<kb>KB\d*).*(?<Version>17134\.\d*)')$versiontableraw += [regex]::Matches($websitecontent.Rawcontent,'(?<date>\w+ \d{1,2}, \d{4}).*(?<kb>KB\d*).*(?<Version>17763\.\d*)')$versiontable = $versiontableraw | Select-Object @{Name='Kb Number';Expression={($_.groups)[2].value.TrimStart('KB')}},@{Name='Release date';Expression={(get-date ($_.groups)[1].value)}},@{Name='Windows Version';Expression={($_.groups)[3].Value}}$versiontable